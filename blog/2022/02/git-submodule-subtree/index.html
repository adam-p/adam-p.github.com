<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><meta name=google-site-verification content="WxZdzPANRFpehqogDMcTc9HLGXXDJy5If07MuUZvHho"><link rel=icon type=image/png href=../../../../favicon.png><link rel=stylesheet href=../../../../scss/styles.css><title>Git Submodule vs Subtree | adam-p</title></head><body><nav class="navbar navbar-expand-md navbar-light bg-light"><div class=container-fluid><a class=navbar-brand href=../../../../>adam-p
</a><button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarNav aria-controls=navbarNav aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarNav><ul class=navbar-nav><li class=nav-item><a class=nav-link href=../../../../blog/>Blog</a></li><li class=nav-item><a class=nav-link href=../../../../inco/>In/Co</a></li><li class=nav-item><a class=nav-link href=../../../../projects/>Projects</a></li><li class=nav-item><a class=nav-link href=../../../../cv/>CV</a></li></ul></div></div></nav><div class=container-fluid><section><h1 class=title><a href=../../../../blog/2022/02/git-submodule-subtree/>Git Submodule vs Subtree</a></h1><h5 class=text-end>February 17, 2022</h5><div><article><p>Every now and then I need to make a choice between using git submodules or subtrees (or nothing), or I get asked about them by coworkers. This is infrequent enough that I forget some of the details each time and need to refresh my memory. So I wrote up these notes to share with my coworkers and to help my future self. Hopefully they’re of some use to others as well.</p><p>Disclaimer: My experience still isn’t large. I’ve only used each once or twice. And this isn’t a manual for using those commands/tools &ndash; it’s just a concise aid for choosing between them.</p><p>TL;DR: Subtree is better if you basically want to forget you have external code, or only infrequently update it; submodule is better if you <em>don’t</em> want to forget that the code is external, and/or if you maybe want to edit and push it.</p><p>I’d seen a lot of complaining about submodule during research, and had the vague idea that subtree was “better”, but I’ve come to realize that submodule has its place.</p><p>When you use subtree, you’re basically copying a remote code base into your file structure. The auto-commit comment at the moment you do it will record the remote commit hash, but otherwise there’s no indication anywhere in the repo that a) the subtree happened, b) what the remote repo was, or c) what the commit of the remote repo was.</p><p>From then on, any changes to the subtree code will be treated just like changes anywhere else in the repo. Any operations to <code>git subtree push</code> and <code>git subtree pull</code> the code does weird git directory slicing (which I’ve used before to create a new repo from the subdirectory of an existing repo, retaining commit history for the files in that directory). It’s okay, but clunky.</p><p>This is in sharp contrast with submodule, where the remote repo code is <em>not</em> copied. Instead, the remote repo URL is recorded, and its location in the file structure, and the remote repo commit to use. When you clone the repo, you have to separately clone the submodule dependency(ies) (<code>git submodule init</code>+<code>git submodule update</code> or <code>git clone --recurse-submodules</code>). The submodule becomes a separate repo in the file structure, with its own <code>.git</code> dir. For example, if you do <code>git status</code> in the submodule directory, it tells you the status of the submodule code and not the outer repo. If you update the submodule repo directory, it changes the submodule&rsquo;s tracked commit in the outer repo, and you commit that in the outer repo.</p><p>Treating the submodule as a separate entity is easy. You can just do all your usual branching, committing, pushing (the remote is the subrepo remote, not the outer remote).</p><p>Cloning the subtree is easier because there’s no separate step, but that&rsquo;s not a big deal. For vendoring 3rd party code, submodule won’t actually make a copy, so that’s not okay<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> (unless you fork the 3rd party code first and submodule the fork).</p><p>So the main decision factors are like:</p><ul><li>Use <strong>subtree</strong> when you just want to copy code from an external repo once, or maybe with occasional pulls.</li><li>Use <strong>submodule</strong> when you want to make your relationship to the external repo really explicit, or if you intend to make changes to the submodule code from within the context of your repo and push to the external repo.</li></ul><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>Depending on your vendoring policy and the dependency management system.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></article></div></section><hr><aside><p><h5>571 Words</h5></p><p>Last Update:
<time datetime="Thu Feb 20 27:29:98 17170 -0500" class=text-muted>February 17, 2022</time><br><a href=https://github.com/adam-p/adam-p.github.com/commits/master/content//blog/2022-02-17-git-submodule-subtree>See revision history</a></p><p>Next: <a class=next href=../../../../blog/2022/02/ipv6-rate-limiting/>The scary state of IPv6 rate-limiting</a><br>Previous: <a class=previous href=../../../../blog/2022/01/golang-http-server-timeouts/>Diving into Go's HTTP server timeouts</a></p></aside><footer class=text-end><small>© 2025 Adam Pritchard</small></footer></div><script src=../../../../node_modules/bootstrap/dist/js/bootstrap.js></script></body></html>